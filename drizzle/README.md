[← Root](../README.md)

# drizzle/

SQL migration files generated by `drizzle-kit` and their metadata snapshots. Migrations are forward-only (no down migrations) and use idempotent guards (`IF NOT EXISTS`, `IF EXISTS`).

## Migration History

Previous incremental migrations (0000–0008) have been consolidated into a single baseline migration.

| Index | Tag | Description |
|-------|-----|-------------|
| 0000 | `baseline` | Consolidated baseline: all tables, enums, indexes, and foreign keys |

## Structure

```
drizzle/
├── 0000_baseline.sql          Consolidated baseline migration
├── relations.ts               Drizzle relation definitions
├── schema.ts                  Drizzle schema (re-export)
└── meta/
    ├── _journal.json          Migration journal
    └── 0000_snapshot.json     Schema snapshot
```

## Creating a New Migration

```bash
# 1. Edit db/schema.ts with your changes
# 2. Generate a migration:
pnpm exec drizzle-kit generate

# 3. Review the generated SQL in drizzle/
# 4. Apply to your database:
pnpm exec drizzle-kit push
```

### Configuration

Drizzle-kit is configured in `drizzle.config.ts`:
- **Schema source:** `./db/schema.ts`
- **Output directory:** `./drizzle/`
- **Dialect:** `postgresql`
- **Strict mode:** enabled (warns on destructive changes)
- **Credentials:** `DATABASE_URL` env var

## Notes

- All migrations use idempotent SQL (`IF NOT EXISTS` / `IF EXISTS`) for safe re-runs
- The `meta/_journal.json` tracks migration ordering and is managed by drizzle-kit — do not edit manually
- Snapshot files in `meta/` capture the full schema state at each migration point for diffing

---

[← Root](../README.md) · [DB](../db/README.md) · [App](../app/README.md)
